/*!
 * guide v1.0.0
 * author: xuesh
 * Date: Tue, 14 Dec 2021 08:26:49 GMT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("fs"),require("path")):"function"==typeof define&&define.amd?define(["fs","path"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).guide=t(e.require$$0,e.require$$1)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=n(e),s=n(t),o={nextLabel:"下一步",nextclass:"",prevLabel:"上一步",prevclass:"",prevEnable:!0,skipLabel:"跳过",skipclass:"",skipEnable:!1,doneLabel:"完成",doneclass:"",doneEnable:!0,confirmtipPosition:"bottom",confirmtipClass:"",overlayOpacity:".7",animation:!1,width:200,height:200,mount:null,unmount:null,jointsClass:"joints-triangle"};let r={};const a=e=>Object.prototype.toString.call(e).slice(1,-1).split(" ")[1].replace(/^[A-Z]/,(e=>e.toLowerCase())),c=["width","height","left","right","top","bottom","margin","margin-top","margin-left","margin-bottom","margin-right"],l=(e,t)=>{if(!t)return;let n="";return e.style.cssText&&(n+=e.style.cssText),"string"==typeof t?n+=t:Object.keys(t).forEach((e=>{c.indexOf(e)>=0&&!isNaN(t[e])?n+=`${e}:${t[e]}px;`:n+=`${e}:${t[e]};`})),e.style.cssText=n,e},u=(e,t)=>{let n=document.createElement(e);t=t||{};for(const e in t){let i=t[e];"style"===e?l(n,i):n.setAttribute(e,i)}return n},p=(e,t)=>{window.scrollBy(e,t)};const h=function(e,t){let n={style:e,class:"guide-step-target guide-overlayer-bgcolor"};return u("div",n)},d=function(e){const t=u("div",{class:"guide-tooltip"});return t.innerHTML=function(e,t,n,i){i=i||function(e,t,n,i,s){var o=t.split("\n"),r=Math.max(i-3,0),a=Math.min(o.length,i+3),c=s(n),l=o.slice(r,a).map((function(e,t){var n=t+r+1;return(n==i?" >> ":"    ")+n+"| "+e})).join("\n");throw e.path=c,e.message=(c||"ejs")+":"+i+"\n"+l+"\n\n"+e.message,e},t=t||function(e){return null==e?"":String(e).replace(o,r)};var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},o=/[&<>'"]/g;function r(e){return s[e]||e}var a=1;try{var c="";function n(e){null!=e&&(c+=e)}return n('<div class="guide-joints '),n(t(e.jointsClass)),n('">\n</div>\n<div class="guide-tooltip-main">\n    <div class="guide-container"></div>\n    <div class="guide-button-box">\n        <div class="guide-button guide-next-button '),a=6,n(t(e.nextclass)),n('" code="next" steps="'),n(t(e.name)),n('">\n            '),a=7,n(t(e.nextLabel)),n("\n        </div>\n\n        "),a=10,e.prevEnable&&(n('\n            <div class="guide-button guide-prev-button '),a=11,n(t(e.prevclass)),n('" code="prev" steps="'),n(t(e.name)),n('">\n                '),a=12,n(t(e.prevLabel)),n("\n            </div>\n            "),a=14),n("\n\n                "),a=16,e.skipEnable&&(n('\n                    <div class="guide-button guide-skip-button '),a=17,n(t(e.skipclass)),n('" code="skip"\n                        steps="'),a=18,n(t(e.name)),n('">\n                        '),a=19,n(t(e.skipLabel)),n("\n                    </div>\n                    "),a=21),n("\n                        "),a=22,e.doneEnable&&(n('\n                            <div class="guide-button guide-done-button '),a=23,n(t(e.doneclass)),n('" code="done"\n                                steps="'),a=24,n(t(e.name)),n('">\n                                '),a=25,n(t(e.doneLabel)),n("\n                            </div>\n                            "),a=27),n("\n\n    </div>\n</div>"),a=30,c}catch(e){i(e,'<div class="guide-joints <%= locals.jointsClass %>">\n</div>\n<div class="guide-tooltip-main">\n    <div class="guide-container"></div>\n    <div class="guide-button-box">\n        <div class="guide-button guide-next-button <%= locals.nextclass %>" code="next" steps="<%= locals.name %>">\n            <%= locals.nextLabel %>\n        </div>\n\n        <% if(locals.prevEnable){ %>\n            <div class="guide-button guide-prev-button <%= locals.prevclass %>" code="prev" steps="<%= locals.name %>">\n                <%= locals.prevLabel %>\n            </div>\n            <% } %>\n\n                <% if(locals.skipEnable){ %>\n                    <div class="guide-button guide-skip-button <%= locals.skipclass %>" code="skip"\n                        steps="<%= locals.name %>">\n                        <%= locals.skipLabel %>\n                    </div>\n                    <% } %>\n                        <% if(locals.doneEnable){ %>\n                            <div class="guide-button guide-done-button <%= locals.doneclass %>" code="done"\n                                steps="<%= locals.name %>">\n                                <%= locals.doneLabel %>\n                            </div>\n                            <%}%>\n\n    </div>\n</div>',void 0,a,t)}}({name:e,...this}),t};var m={content:"",width:"",height:"",offsetX:"0",offsetY:"0",position:"bottom",tipClass:"",jointsX:"",jointsY:"",mount:null,unmount:null,template:"template1"},g={},f={};!function(e){var t=/[|\\{}()[\]^$+*?.]/g;e.escapeRegExpChars=function(e){return e?String(e).replace(t,"\\$&"):""};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},i=/[&<>'"]/g;function s(e){return n[e]||e}e.escapeXML=function(e){return null==e?"":String(e).replace(i,s)},e.escapeXML.toString=function(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'},e.shallowCopy=function(e,t){for(var n in t=t||{})e[n]=t[n];return e},e.shallowCopyFromList=function(e,t,n){for(var i=0;i<n.length;i++){var s=n[i];void 0!==t[s]&&(e[s]=t[s])}return e},e.cache={_data:{},set:function(e,t){this._data[e]=t},get:function(e){return this._data[e]},remove:function(e){delete this._data[e]},reset:function(){this._data={}}},e.hyphenToCamel=function(e){return e.replace(/-[a-z]/g,(function(e){return e[1].toUpperCase()}))}}(f);var v="3.1.6";!function(e){
/**
	 * @file Embedded JavaScript templating engine. {@link http://ejs.co}
	 * @author Matthew Eernisse <mde@fleegix.org>
	 * @author Tiancheng "Timothy" Gu <timothygu99@gmail.com>
	 * @project EJS
	 * @license {@link http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0}
	 */
var t=i.default,n=s.default,o=f,r=!1,a=v,c="locals",l=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],u=l.concat("cache"),p=/^\uFEFF/;function h(n,i){var s;if(i.some((function(i){return s=e.resolveInclude(n,i,!0),t.existsSync(s)})))return s}function d(t,n){var i,s=t.filename,o=arguments.length>1;if(t.cache){if(!s)throw new Error("cache option requires a filename");if(i=e.cache.get(s))return i;o||(n=g(s).toString().replace(p,""))}else if(!o){if(!s)throw new Error("Internal EJS error: no file name or template provided");n=g(s).toString().replace(p,"")}return i=e.compile(n,t),t.cache&&e.cache.set(s,i),i}function m(t,n,i){var s;if(!i){if("function"==typeof e.promiseImpl)return new e.promiseImpl((function(e,i){try{e(s=d(t)(n))}catch(e){i(e)}}));throw new Error("Please provide a callback function")}try{s=d(t)(n)}catch(e){return i(e)}i(null,s)}function g(t){return e.fileLoader(t)}function b(n,i){var s=o.shallowCopy({},i);if(s.filename=function(n,i){var s,o,r=i.views,a=/^[A-Za-z]+:\\|^\//.exec(n);if(a&&a.length)n=n.replace(/^\/*/,""),s=Array.isArray(i.root)?h(n,i.root):e.resolveInclude(n,i.root||"/",!0);else if(i.filename&&(o=e.resolveInclude(n,i.filename),t.existsSync(o)&&(s=o)),!s&&Array.isArray(r)&&(s=h(n,r)),!s&&"function"!=typeof i.includer)throw new Error('Could not find the include file "'+i.escapeFunction(n)+'"');return s}(n,s),"function"==typeof i.includer){var r=i.includer(n,s.filename);if(r&&(r.filename&&(s.filename=r.filename),r.template))return d(s,r.template)}return d(s)}function y(e,t,n,i,s){var o=t.split("\n"),r=Math.max(i-3,0),a=Math.min(o.length,i+3),c=s(n),l=o.slice(r,a).map((function(e,t){var n=t+r+1;return(n==i?" >> ":"    ")+n+"| "+e})).join("\n");throw e.path=c,e.message=(c||"ejs")+":"+i+"\n"+l+"\n\n"+e.message,e}function S(e){return e.replace(/;(\s*$)/,"$1")}function w(t,n){n=n||{};var i={};this.templateText=t,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",i.client=n.client||!1,i.escapeFunction=n.escape||n.escapeFunction||o.escapeXML,i.compileDebug=!1!==n.compileDebug,i.debug=!!n.debug,i.filename=n.filename,i.openDelimiter=n.openDelimiter||e.openDelimiter||"<",i.closeDelimiter=n.closeDelimiter||e.closeDelimiter||">",i.delimiter=n.delimiter||e.delimiter||"%",i.strict=n.strict||!1,i.context=n.context,i.cache=n.cache||!1,i.rmWhitespace=n.rmWhitespace,i.root=n.root,i.includer=n.includer,i.outputFunctionName=n.outputFunctionName,i.localsName=n.localsName||e.localsName||c,i.views=n.views,i.async=n.async,i.destructuredLocals=n.destructuredLocals,i.legacyInclude=void 0===n.legacyInclude||!!n.legacyInclude,i.strict?i._with=!1:i._with=void 0===n._with||n._with,this.opts=i,this.regex=this.createRegex()}e.cache=o.cache,e.fileLoader=t.readFileSync,e.localsName=c,e.promiseImpl=new Function("return this;")().Promise,e.resolveInclude=function(e,t,i){var s=n.dirname,o=n.extname,r=(0,n.resolve)(i?t:s(t),e);return o(e)||(r+=".ejs"),r},e.compile=function(e,t){return t&&t.scope&&(r||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),r=!0),t.context||(t.context=t.scope),delete t.scope),new w(e,t).compile()},e.render=function(e,t,n){var i=t||{},s=n||{};return 2==arguments.length&&o.shallowCopyFromList(s,i,l),d(s,e)(i)},e.renderFile=function(){var e,t,n,i=Array.prototype.slice.call(arguments),s=i.shift(),r={filename:s};return"function"==typeof arguments[arguments.length-1]&&(e=i.pop()),i.length?(t=i.shift(),i.length?o.shallowCopy(r,i.pop()):(t.settings&&(t.settings.views&&(r.views=t.settings.views),t.settings["view cache"]&&(r.cache=!0),(n=t.settings["view options"])&&o.shallowCopy(r,n)),o.shallowCopyFromList(r,t,u)),r.filename=s):t={},m(r,t,e)},e.Template=w,e.clearCache=function(){e.cache.reset()},w.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},w.prototype={createRegex:function(){var e="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",t=o.escapeRegExpChars(this.opts.delimiter),n=o.escapeRegExpChars(this.opts.openDelimiter),i=o.escapeRegExpChars(this.opts.closeDelimiter);return e=e.replace(/%/g,t).replace(/</g,n).replace(/>/g,i),new RegExp(e)},compile:function(){var e,t,i,s=this.opts,r="",a="",c=s.escapeFunction,l=s.filename?JSON.stringify(s.filename):"undefined";if(!this.source){if(this.generateSource(),r+='  var __output = "";\n  function __append(s) { if (s !== undefined && s !== null) __output += s }\n',s.outputFunctionName&&(r+="  var "+s.outputFunctionName+" = __append;\n"),s.destructuredLocals&&s.destructuredLocals.length){for(var u="  var __locals = ("+s.localsName+" || {}),\n",p=0;p<s.destructuredLocals.length;p++){var h=s.destructuredLocals[p];p>0&&(u+=",\n  "),u+=h+" = __locals."+h}r+=u+";\n"}!1!==s._with&&(r+="  with ("+s.localsName+" || {}) {\n",a+="  }\n"),a+="  return __output;\n",this.source=r+this.source+a}e=s.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+l+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,s.client&&(e="escapeFn = escapeFn || "+c.toString()+";\n"+e,s.compileDebug&&(e="rethrow = rethrow || "+y.toString()+";\n"+e)),s.strict&&(e='"use strict";\n'+e),s.debug&&console.log(e),s.compileDebug&&s.filename&&(e=e+"\n//# sourceURL="+l+"\n");try{if(s.async)try{i=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?new Error("This environment does not support async/await"):e}else i=Function;t=new i(s.localsName+", escapeFn, include, rethrow",e)}catch(e){throw e instanceof SyntaxError&&(s.filename&&(e.message+=" in "+s.filename),e.message+=" while compiling ejs\n\n",e.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",e.message+="https://github.com/RyanZim/EJS-Lint",s.async||(e.message+="\n",e.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),e}var d=s.client?t:function(e){return t.apply(s.context,[e||{},c,function(t,n){var i=o.shallowCopy({},e);return n&&(i=o.shallowCopy(i,n)),b(t,s)(i)},y])};if(s.filename&&"function"==typeof Object.defineProperty){var m=s.filename,g=n.basename(m,n.extname(m));try{Object.defineProperty(d,"name",{value:g,writable:!1,enumerable:!1,configurable:!0})}catch(e){}}return d},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var e=this,t=this.parseTemplateText(),n=this.opts.delimiter,i=this.opts.openDelimiter,s=this.opts.closeDelimiter;t&&t.length&&t.forEach((function(o,r){var a;if(0===o.indexOf(i+n)&&0!==o.indexOf(i+n+n)&&(a=t[r+2])!=n+s&&a!="-"+n+s&&a!="_"+n+s)throw new Error('Could not find matching close tag for "'+o+'".');e.scanLine(o)}))},parseTemplateText:function(){for(var e,t=this.templateText,n=this.regex,i=n.exec(t),s=[];i;)0!==(e=i.index)&&(s.push(t.substring(0,e)),t=t.slice(e)),s.push(i[0]),t=t.slice(i[0].length),i=n.exec(t);return t&&s.push(t),s},_addOutput:function(e){if(this.truncate&&(e=e.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!e)return e;e=(e=(e=(e=e.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+e+'")\n'},scanLine:function(e){var t,n=this.opts.delimiter,i=this.opts.openDelimiter,s=this.opts.closeDelimiter;switch(t=e.split("\n").length-1,e){case i+n:case i+n+"_":this.mode=w.modes.EVAL;break;case i+n+"=":this.mode=w.modes.ESCAPED;break;case i+n+"-":this.mode=w.modes.RAW;break;case i+n+"#":this.mode=w.modes.COMMENT;break;case i+n+n:this.mode=w.modes.LITERAL,this.source+='    ; __append("'+e.replace(i+n+n,i+n)+'")\n';break;case n+n+s:this.mode=w.modes.LITERAL,this.source+='    ; __append("'+e.replace(n+n+s,n+s)+'")\n';break;case n+s:case"-"+n+s:case"_"+n+s:this.mode==w.modes.LITERAL&&this._addOutput(e),this.mode=null,this.truncate=0===e.indexOf("-")||0===e.indexOf("_");break;default:if(this.mode){switch(this.mode){case w.modes.EVAL:case w.modes.ESCAPED:case w.modes.RAW:e.lastIndexOf("//")>e.lastIndexOf("\n")&&(e+="\n")}switch(this.mode){case w.modes.EVAL:this.source+="    ; "+e+"\n";break;case w.modes.ESCAPED:this.source+="    ; __append(escapeFn("+S(e)+"))\n";break;case w.modes.RAW:this.source+="    ; __append("+S(e)+")\n";break;case w.modes.COMMENT:break;case w.modes.LITERAL:this._addOutput(e)}}else this._addOutput(e)}this.opts.compileDebug&&t&&(this.currentLine+=t,this.source+="    ; __line = "+this.currentLine+"\n")}},e.escapeXML=o.escapeXML,e.__express=e.renderFile,e.VERSION=a,e.name="ejs","undefined"!=typeof window&&(window.ejs=e)}(g),console.log(111111,g);class b{constructor(e){this.container=null,this.setOptions(m),this.setOptions(e)}setOption(e,t){if(e)return this[e]=t,this}setOptions(e){if(e)return Object.keys(e).forEach((t=>{this.setOption(t,e[t])})),this}setTipContent(e){if(!e||"hTMLDivElement"!==a(e))return;e.querySelector(".guide-container").innerHTML=function(e,t,n,i){i=i||function(e,t,n,i,s){var o=t.split("\n"),r=Math.max(i-3,0),a=Math.min(o.length,i+3),c=s(n),l=o.slice(r,a).map((function(e,t){var n=t+r+1;return(n==i?" >> ":"    ")+n+"| "+e})).join("\n");throw e.path=c,e.message=(c||"ejs")+":"+i+"\n"+l+"\n\n"+e.message,e},t=t||function(e){return null==e?"":String(e).replace(o,r)};var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},o=/[&<>'"]/g;function r(e){return s[e]||e}var a=1;try{var c="";function n(e){null!=e&&(c+=e)}return n('<style>.guide-tip-template1 {\n  width: 100%;\n  height: 100%;\n  font-family: PingFang SC;\n  color: rgba(47, 46, 63, 0.85); }\n  .guide-tip-template1 .guide-message {\n    flex: 1; }\n    .guide-tip-template1 .guide-message h3 {\n      align-items: center;\n      letter-spacing: 1px;\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: 600;\n      font-size: 20px;\n      line-height: 28px;\n      color: #2878ff;\n      margin: 0; }\n    .guide-tip-template1 .guide-message p {\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: normal;\n      font-size: 14px;\n      line-height: 22px;\n      color: rgba(47, 46, 63, 0.65);\n      margin-top: 8px; }\n</style>\n<div class="guide-tip-template1">\n    '),a=28,Array.isArray(e)&&(n("\n        "),a=29,e.forEach((function(e){n("\n            <div>\n                "),a=31,e.image&&(n('\n                    <div class="guide-image">\n                        <img src="'),a=33,n(t(e.image)),n('" alt="" />\n                    </div>\n                    '),a=35),n('\n                        <div class="guide-message">\n                            <h3>\n                                '),a=38,n(t(e.title)),n("\n                            </h3>\n                            <p>\n                                "),a=41,n(t(e.text)),n("\n                            </p>\n                        </div>\n            </div>\n            "),a=45})),n("\n                "),a=46),n("\n\n</div>"),a=48,c}catch(e){i(e,'<style>.guide-tip-template1 {\n  width: 100%;\n  height: 100%;\n  font-family: PingFang SC;\n  color: rgba(47, 46, 63, 0.85); }\n  .guide-tip-template1 .guide-message {\n    flex: 1; }\n    .guide-tip-template1 .guide-message h3 {\n      align-items: center;\n      letter-spacing: 1px;\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: 600;\n      font-size: 20px;\n      line-height: 28px;\n      color: #2878ff;\n      margin: 0; }\n    .guide-tip-template1 .guide-message p {\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: normal;\n      font-size: 14px;\n      line-height: 22px;\n      color: rgba(47, 46, 63, 0.65);\n      margin-top: 8px; }\n</style>\n<div class="guide-tip-template1">\n    <% if(Array.isArray(locals)) { %>\n        <% locals.forEach(function(item){ %>\n            <div>\n                <% if (item.image) { %>\n                    <div class="guide-image">\n                        <img src="<%= item.image %>" alt="" />\n                    </div>\n                    <% } %>\n                        <div class="guide-message">\n                            <h3>\n                                <%= item.title %>\n                            </h3>\n                            <p>\n                                <%= item.text %>\n                            </p>\n                        </div>\n            </div>\n            <% }) %>\n                <% }%>\n\n</div>',void 0,a,t)}}(this.content)}setTargetPosition(e){const t=document.querySelector(this.el);if((e=>{const t=document.querySelector(e);if(!t||!t.getClientRects().length)return;const{width:n,height:i,top:s,left:o}=t.getClientRects()[0];(s<0||s>outerHeight-i)&&p(0,s-i)})(this.el),document.querySelector(".guide-target")?.classList.remove("guide-target"),t&&t.getClientRects().length){t.classList.add("guide-target");const{width:n,height:i,top:s,left:o}=t.getClientRects()[0];l(e,{width:n,height:i,top:s,left:o,display:"block"})}else l(e,{width:0,height:0,top:0,left:0,display:"block"})}setTipPosition(e,t){if(t&&e){this.el&&document.querySelector(this.el)||(this.position="center");const{width:n,height:i,top:s,left:o}=t.getClientRects()[0],r={targetWidth:n,targetHeight:i,targetTop:s,targetLeft:o};switch(this.position){case"bottom":this._positionBottom(e,r);break;case"top":this._positionTop(e,r);break;case"left":this._positionLeft(e,r);break;case"right":this._positionRight(e,r);break;default:this._positionCenter(e)}e.className=`guide-tooltip guide-tooltip-${this.position}`}}_positionCenter(e){const{width:t,height:n}=e.getClientRects()[0];console.log(document.body.offsetWidth,document.body.offsetHeight),console.log(t,n),l(e,{top:window.screen.height/2-n/2,left:document.body.clientWidth/2-t/2})}_positionBottom(e,{targetWidth:t,targetHeight:n,targetTop:i,targetLeft:s}){const{width:o}=e.getClientRects()[0];l(e,{top:i+n,left:s+(t-o)/2})}_positionTop(e,{targetWidth:t,targetHeight:n,targetTop:i,targetLeft:s}){const{width:o,height:r}=e.getClientRects()[0];l(e,{top:i-r,left:s+(t-o)/2})}_positionLeft(e,{targetWidth:t,targetHeight:n,targetTop:i,targetLeft:s}){const{width:o,height:r}=e.getClientRects()[0];l(e,{top:i-(r-n)/2,left:s-o})}_positionRight(e,{targetWidth:t,targetHeight:n,targetTop:i,targetLeft:s}){const{height:o}=e.getClientRects()[0];l(e,{top:i-(o-n)/2,left:s+t})}positionOffset(e){if(!e||"hTMLDivElement"!==a(e))return;e.style.transform=`translate(${this.offsetX||0}px, ${this.offsetY||0}px)`;e.querySelector(".guide-joints").style.transform=`translate(${this.jointsX||0}px, ${this.jointsY||0}px)`}}return class{constructor(e){this.version="1.0.0",this.steps=null,this.activeSteps={},this.overlayer=null,this.setOptions(o),this.setOptions(e),this.bindEvent()}setOption(e,t){if(e)return this[e]=t,this}setOptions(e){if(e)return Object.keys(e).forEach((t=>{this.setOption(t,e[t])})),this}start(e){if(this.steps&&0!==this.steps?.length)return this._createOverlayer(),this.setStepsState(e,!0),this.activeSteps[e]}setStepsState(e,t){const n=this.steps[e];if(t){if(this.activeSteps[e])return;this.activeSteps[e]={stepNumber:-1,steps:n},this._createGuideTargetBox(e),this._createGuideTipBox(e),this.body.appendChild(this.activeSteps[e].targetElement),this.body.appendChild(this.activeSteps[e].tipElement),this._switchStepsNumber(e),this.setStepsNumber(e,0),l(this.overlayer,{display:"block"}),"function"===a(this.mount)&&this.mount(e,this.activeSteps[e])}else"function"===a(this.activeSteps[e].currentStep?.unmount)&&this.activeSteps[e].currentStep.unmount(e,this.activeSteps[e].currentStep),"function"===a(this.unmount)&&this.unmount(e,this.activeSteps[e]),this.remove(e),delete this.activeSteps[e]}_switchStepsNumber(e){var t,n;n=e=>{const t=Array.prototype.shift.call(e);if(!this.activeSteps[t])return;const{stepNumber:n,steps:i}=this.activeSteps[t],s=new b(i[n]);this.setStep(s,this.activeSteps[t]),"function"===a(this.activeSteps[t].currentStep?.unmount)&&this.activeSteps[t].currentStep.unmount(t,this.activeSteps[t].currentStep),this.activeSteps[t].currentStep=s,"function"===a(s.mount)&&s.mount(t,s),this.buttonState(this.activeSteps[t])},r[t=e]||(r[t]=[]),r[t].push(n)}setStep(e,t){const{tipElement:n,targetElement:i}=t;e.setTargetPosition(i),e.setTipContent(n),e.setTipPosition(n,i),e.positionOffset(n)}setStepsNumber(e,t){const n=this.activeSteps[e];if(!n)return;"number"===a(t)?n.stepNumber=t:"++"===t?n.stepNumber++:"--"===t&&n.stepNumber--;const i=n.steps.length;n.stepNumber>=0&&n.stepNumber<i?((...e)=>{let t=e[0];const n=r[t];if(!n||0===n.length)return!1;for(var i,s=0;i=n[s++];)i(e)})(e,n.stepNumber):this.setStepsState(e,!1)}remove(e){e?(this._removeGuideTargetBox(e),this._removeGuideTipBox(e),l(this.overlayer,{display:"none"})):console.error("缺少steps name.")}_createOverlayer(){this.overlayer||(this.overlayer=u("div",{style:{display:"none"},class:"guide-overlayer"}),this.body||(this.body=document.getElementsByTagName("body")[0]),this.body.appendChild(this.overlayer))}_removeOverlayer(){this.overlayer?.remove(),this.overlayer=null}_createGuideTargetBox(e){if(!e)return void console.error("缺少 step name");const t=h.call(this,{display:"none"},e);this.activeSteps[e].targetElement=t}_createGuideTipBox(e){if(!e)return void console.error("缺少 step name");const t=d.call(this,e);this.activeSteps[e].tipElement=t}_removeGuideTargetBox(e){e?this.activeSteps[e]?.targetElement?.remove():console.error("缺少 step name")}_removeGuideTipBox(e){e?this.activeSteps[e]?.tipElement?.remove():console.error("缺少 step name")}bindEvent(){this.body=document.getElementsByTagName("body")[0],this.body.onclick=e=>{const t=e.target;if(Array.prototype.includes.call(t.classList,"guide-button")){const e=t.getAttribute("code"),n=t.getAttribute("steps");switch(e){case"prev":this.Prev(n);break;case"skip":this.Skip(n);break;case"done":this.Done(n);break;default:this.Next(n)}}};const e=()=>{Object.values(this.activeSteps).forEach((e=>{if(e.currentStep){const{tipElement:t,targetElement:n}=e;e.currentStep.setTargetPosition(n),e.currentStep.setTipPosition(t,n)}}))};window.onresize=()=>{e()},window.onscroll=()=>{e()}}Next(e){e&&this.setStepsNumber(e,"++")}Prev(e){e&&this.setStepsNumber(e,"--")}Skip(e){e&&this.setStepsState(e,!1)}Done(e){e&&this.setStepsNumber(e,"++")}buttonState(e){const t=this.activeSteps;Object.values(t).forEach((t=>{const{tipElement:n}=t,i=n.querySelector(".guide-button.guide-next-button"),s=n.querySelector(".guide-button.guide-prev-button"),o=n.querySelector(".guide-button.guide-done-button"),{stepNumber:r,steps:a}=e,c=a.length;r>0?(s?.classList.remove("hide"),s?.classList.add("show")):(s?.classList.remove("show"),s?.classList.add("hide")),o&&r===c-1?(i?.classList.remove("show"),i?.classList.add("hide"),o?.classList.remove("hide"),o?.classList.add("show")):(o?.classList.remove("show"),o?.classList.add("hide"),i?.classList.remove("hide"),i?.classList.add("show"))}))}}}));
