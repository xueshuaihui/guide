/*!
 * guide v1.0.0
 * author: xuesh
 * Date: Thu, 09 Dec 2021 02:41:21 GMT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).guide=e()}(this,(function(){"use strict";var t={nextLabel:"下一步",nextclass:"",prevLabel:"上一步",prevclass:"",prevEnable:!0,skipLabel:"跳过",skipclass:"",skipEnable:!1,doneLabel:"完成",doneclass:"",doneEnable:!0,confirmtipPosition:"bottom",confirmtipClass:"",overlayOpacity:".7",animation:!1,width:200,height:200,mount:null,unmount:null};let e={};const i=t=>Object.prototype.toString.call(t).slice(1,-1).split(" ")[1].replace(/^[A-Z]/,(t=>t.toLowerCase())),n=["width","height","left","right","top","bottom","margin","margin-top","margin-left","margin-bottom","margin-right"],s=(t,e)=>{if(!e)return;let i="";return t.style.cssText&&(i+=t.style.cssText),"string"==typeof e?i+=e:Object.keys(e).forEach((t=>{n.indexOf(t)>=0&&!isNaN(e[t])?i+=`${t}:${e[t]}px;`:i+=`${t}:${e[t]};`})),t.style.cssText=i,t},o=(t,e)=>{let i=document.createElement(t);e=e||{};for(const t in e){let n=e[t];"style"===t?s(i,n):i.setAttribute(t,n)}return i},a=(t,e)=>{window.scrollBy(t,e)};const r=function(t,e){let i={style:t,class:"guide-step-target guide-overlayer-bgcolor"};return o("div",i)},l=function(t){const e=o("div",{class:"guide-tooltip"});return e.innerHTML=function(t,e,i,n){n=n||function(t,e,i,n,s){var o=e.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),l=s(i),c=o.slice(a,r).map((function(t,e){var i=e+a+1;return(i==n?" >> ":"    ")+i+"| "+t})).join("\n");throw t.path=l,t.message=(l||"ejs")+":"+n+"\n"+c+"\n\n"+t.message,t},e=e||function(t){return null==t?"":String(t).replace(o,a)};var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},o=/[&<>'"]/g;function a(t){return s[t]||t}var r=1;try{var l="";function i(t){null!=t&&(l+=t)}return i('<div class="guide-joints joints-triangle">\n</div>\n<div class="guide-tooltip-main">\n    <div class="guide-container"></div>\n    <div class="guide-button-box">\n        <div class="guide-button guide-next-button '),r=6,i(e(t.nextclass)),i('" code="next" steps="'),i(e(t.name)),i('">\n            '),r=7,i(e(t.nextLabel)),i("\n        </div>\n\n        "),r=10,t.prevEnable&&(i('\n            <div class="guide-button guide-prev-button '),r=11,i(e(t.prevclass)),i('" code="prev" steps="'),i(e(t.name)),i('">\n                '),r=12,i(e(t.prevLabel)),i("\n            </div>\n            "),r=14),i("\n\n                "),r=16,t.skipEnable&&(i('\n                    <div class="guide-button guide-skip-button '),r=17,i(e(t.skipclass)),i('" code="skip"\n                        steps="'),r=18,i(e(t.name)),i('">\n                        '),r=19,i(e(t.skipLabel)),i("\n                    </div>\n                    "),r=21),i("\n                        "),r=22,t.doneEnable&&(i('\n                            <div class="guide-button guide-done-button '),r=23,i(e(t.doneclass)),i('" code="done"\n                                steps="'),r=24,i(e(t.name)),i('">\n                                '),r=25,i(e(t.doneLabel)),i("\n                            </div>\n                            "),r=27),i("\n\n    </div>\n</div>"),r=30,l}catch(t){n(t,'<div class="guide-joints joints-triangle">\n</div>\n<div class="guide-tooltip-main">\n    <div class="guide-container"></div>\n    <div class="guide-button-box">\n        <div class="guide-button guide-next-button <%= locals.nextclass %>" code="next" steps="<%= locals.name %>">\n            <%= locals.nextLabel %>\n        </div>\n\n        <% if(locals.prevEnable){ %>\n            <div class="guide-button guide-prev-button <%= locals.prevclass %>" code="prev" steps="<%= locals.name %>">\n                <%= locals.prevLabel %>\n            </div>\n            <% } %>\n\n                <% if(locals.skipEnable){ %>\n                    <div class="guide-button guide-skip-button <%= locals.skipclass %>" code="skip"\n                        steps="<%= locals.name %>">\n                        <%= locals.skipLabel %>\n                    </div>\n                    <% } %>\n                        <% if(locals.doneEnable){ %>\n                            <div class="guide-button guide-done-button <%= locals.doneclass %>" code="done"\n                                steps="<%= locals.name %>">\n                                <%= locals.doneLabel %>\n                            </div>\n                            <%}%>\n\n    </div>\n</div>',void 0,r,e)}}({name:t,...this}),e};var c={content:"",width:"",height:"",offsetX:"0",offsetY:"0",position:"bottom",tipClass:"",jointsClass:"joints-triangle",jointsX:"",jointsY:"",mount:null,unmount:null};class p{constructor(t){this.container=null,this.setOptions(c),this.setOptions(t)}setOption(t,e){if(t)return this[t]=e,this}setOptions(t){if(t)return Object.keys(t).forEach((e=>{this.setOption(e,t[e])})),this}setTipContent(t){if(!t||"hTMLDivElement"!==i(t))return;t.querySelector(".guide-container").innerHTML=function(t,e,i,n){n=n||function(t,e,i,n,s){var o=e.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),l=s(i),c=o.slice(a,r).map((function(t,e){var i=e+a+1;return(i==n?" >> ":"    ")+i+"| "+t})).join("\n");throw t.path=l,t.message=(l||"ejs")+":"+n+"\n"+c+"\n\n"+t.message,t},e=e||function(t){return null==t?"":String(t).replace(o,a)};var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},o=/[&<>'"]/g;function a(t){return s[t]||t}var r=1;try{var l="";function i(t){null!=t&&(l+=t)}return i('<style>.guide-tip-template1 {\n  width: 100%;\n  height: 100%;\n  font-family: PingFang SC;\n  color: rgba(47, 46, 63, 0.85); }\n  .guide-tip-template1 .guide-message {\n    flex: 1; }\n    .guide-tip-template1 .guide-message h3 {\n      align-items: center;\n      letter-spacing: 1px;\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: 600;\n      font-size: 20px;\n      line-height: 28px;\n      color: #2878ff;\n      margin: 0; }\n    .guide-tip-template1 .guide-message p {\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: normal;\n      font-size: 14px;\n      line-height: 22px;\n      color: rgba(47, 46, 63, 0.65);\n      margin-top: 8px; }\n</style>\n<div class="guide-tip-template1">\n    '),r=28,Array.isArray(t)&&(i("\n        "),r=29,t.forEach((function(t){i("\n            <div>\n                "),r=31,t.image&&(i('\n                    <div class="guide-image">\n                        <img src="'),r=33,i(e(t.image)),i('" alt="" />\n                    </div>\n                    '),r=35),i('\n                        <div class="guide-message">\n                            <h3>\n                                '),r=38,i(e(t.title)),i("\n                            </h3>\n                            <p>\n                                "),r=41,i(e(t.text)),i("\n                            </p>\n                        </div>\n            </div>\n            "),r=45})),i("\n                "),r=46),i("\n\n</div>"),r=48,l}catch(t){n(t,'<style>.guide-tip-template1 {\n  width: 100%;\n  height: 100%;\n  font-family: PingFang SC;\n  color: rgba(47, 46, 63, 0.85); }\n  .guide-tip-template1 .guide-message {\n    flex: 1; }\n    .guide-tip-template1 .guide-message h3 {\n      align-items: center;\n      letter-spacing: 1px;\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: 600;\n      font-size: 20px;\n      line-height: 28px;\n      color: #2878ff;\n      margin: 0; }\n    .guide-tip-template1 .guide-message p {\n      font-family: PingFang SC;\n      font-style: normal;\n      font-weight: normal;\n      font-size: 14px;\n      line-height: 22px;\n      color: rgba(47, 46, 63, 0.65);\n      margin-top: 8px; }\n</style>\n<div class="guide-tip-template1">\n    <% if(Array.isArray(locals)) { %>\n        <% locals.forEach(function(item){ %>\n            <div>\n                <% if (item.image) { %>\n                    <div class="guide-image">\n                        <img src="<%= item.image %>" alt="" />\n                    </div>\n                    <% } %>\n                        <div class="guide-message">\n                            <h3>\n                                <%= item.title %>\n                            </h3>\n                            <p>\n                                <%= item.text %>\n                            </p>\n                        </div>\n            </div>\n            <% }) %>\n                <% }%>\n\n</div>',void 0,r,e)}}(this.content)}setTargetPosition(t){const e=document.querySelector(this.el);if((t=>{const e=document.querySelector(t);if(!e||!e.getClientRects().length)return;const{width:i,height:n,top:s,left:o}=e.getClientRects()[0];(s<0||s>outerHeight-n)&&a(0,s-n)})(this.el),document.querySelector(".guide-target")?.classList.remove("guide-target"),e&&e.getClientRects().length){e.classList.add("guide-target");const{width:i,height:n,top:o,left:a}=e.getClientRects()[0];s(t,{width:i,height:n,top:o,left:a,display:"block"})}else s(t,{width:0,height:0,top:0,left:0,display:"block"})}setTipPosition(t,e){if(e&&t){this.el||(this.position="center");const{width:i,height:n,top:s,left:o}=e.getClientRects()[0],a={targetWidth:i,targetHeight:n,targetTop:s,targetLeft:o};switch(this.position){case"bottom":this._positionBottom(t,a);break;case"top":this._positionTop(t,a);break;case"left":this._positionLeft(t,a);break;case"right":this._positionRight(t,a);break;default:this._positionCenter(t)}t.className=`guide-tooltip guide-tooltip-${this.position}`}}_positionCenter(t){const{width:e,height:i}=t.getClientRects()[0];console.log(document.body.offsetWidth,document.body.offsetHeight),console.log(e,i),s(t,{top:window.screen.height/2-i/2,left:window.screen.width/2-e/2})}_positionBottom(t,{targetWidth:e,targetHeight:i,targetTop:n,targetLeft:o}){s(t,{top:n+i,left:o})}_positionTop(t,{targetWidth:e,targetHeight:i,targetTop:n,targetLeft:o}){const{height:a}=t.getClientRects()[0];s(t,{top:n-a,left:o})}_positionLeft(t,{targetWidth:e,targetHeight:i,targetTop:n,targetLeft:o}){const{width:a}=t.getClientRects()[0];s(t,{top:n,left:o-a})}_positionRight(t,{targetWidth:e,targetHeight:i,targetTop:n,targetLeft:o}){s(t,{top:n,left:o+e})}}return class{constructor(e){this.version="1.0.0",this.steps=null,this.activeSteps={},this.overlayer=null,this.setOptions(t),this.setOptions(e),this.bindEvent()}setOption(t,e){if(t)return this[t]=e,this}setOptions(t){if(t)return Object.keys(t).forEach((e=>{this.setOption(e,t[e])})),this}start(t){if(this.steps&&0!==this.steps?.length)return this._createOverlayer(),this.setStepsState(t,!0),this}setStepsState(t,e){const n=this.steps[t];if(e){if(this.activeSteps[t])return;this.activeSteps[t]={stepNumber:-1,steps:n},this._createGuideTargetBox(t),this._createGuideTipBox(t),this.body.appendChild(this.activeSteps[t].targetElement),this.body.appendChild(this.activeSteps[t].tipElement),this._switchStepsNumber(t),this.setStepsNumber(t,0),s(this.overlayer,{display:"block"}),"function"===i(this.mount)&&this.mount(t,this.activeSteps[t])}else"function"===i(this.activeSteps[t].currentStep?.unmount)&&this.activeSteps[t].currentStep.unmount(t,this.activeSteps[t].currentStep),"function"===i(this.unmount)&&this.unmount(t,this.activeSteps[t]),this.remove(t),delete this.activeSteps[t]}_switchStepsNumber(t){var n,s;s=t=>{const e=Array.prototype.shift.call(t),{tipElement:n,targetElement:s,stepNumber:o,steps:a}=this.activeSteps[e],r=new p(a[o]);this.setStep(r,this.activeSteps[e]),"function"===i(this.activeSteps[e].currentStep?.unmount)&&this.activeSteps[e].currentStep.unmount(e,this.activeSteps[e].currentStep),this.activeSteps[e].currentStep=r,"function"===i(r.mount)&&r.mount(e,r),this.buttonState(this.activeSteps[e])},e[n=t]||(e[n]=[]),e[n].push(s)}setStep(t,e){const{tipElement:i,targetElement:n}=e;t.setTargetPosition(n),t.setTipContent(i),t.setTipPosition(i,n)}setStepsNumber(t,n){const s=this.activeSteps[t];if(!s)return;"number"===i(n)?s.stepNumber=n:"++"===n?s.stepNumber++:"--"===n&&s.stepNumber--;const o=s.steps.length;s.stepNumber>=0&&s.stepNumber<o?((...t)=>{let i=t[0];const n=e[i];if(!n||0===n.length)return!1;for(var s,o=0;s=n[o++];)s(t)})(t,s.stepNumber):this.setStepsState(t,!1)}remove(t){t?(this._removeGuideTargetBox(t),this._removeGuideTipBox(t),s(this.overlayer,{display:"none"})):console.error("缺少steps name.")}_createOverlayer(){this.overlayer||(this.overlayer=o("div",{style:{display:"none"},class:"guide-overlayer"}),this.body||(this.body=document.getElementsByTagName("body")[0]),this.body.appendChild(this.overlayer))}_removeOverlayer(){this.overlayer?.remove(),this.overlayer=null}_createGuideTargetBox(t){if(!t)return void console.error("缺少 step name");const e=r.call(this,{display:"none"},t);this.activeSteps[t].targetElement=e}_createGuideTipBox(t){if(!t)return void console.error("缺少 step name");const e=l.call(this,t);this.activeSteps[t].tipElement=e}_removeGuideTargetBox(t){t?this.activeSteps[t]?.targetElement?.remove():console.error("缺少 step name")}_removeGuideTipBox(t){t?this.activeSteps[t]?.tipElement?.remove():console.error("缺少 step name")}bindEvent(){this.body=document.getElementsByTagName("body")[0],this.body.onclick=t=>{const e=t.target;if(Array.prototype.includes.call(e.classList,"guide-button")){const t=e.getAttribute("code"),i=e.getAttribute("steps");switch(t){case"prev":this.Prev(i);break;case"skip":this.Skip(i);break;case"done":this.Done(i);break;default:this.Next(i)}}};const t=()=>{Object.values(this.activeSteps).forEach((t=>{if(t.currentStep){const{tipElement:e,targetElement:i}=t;t.currentStep.setTargetPosition(i),t.currentStep.setTipPosition(e,i)}}))};window.onresize=()=>{t()},window.onscroll=()=>{t()}}Next(t){t&&this.setStepsNumber(t,"++")}Prev(t){t&&this.setStepsNumber(t,"--")}Skip(t){t&&this.setStepsState(t,!1)}Done(t){t&&this.setStepsNumber(t,"++")}buttonState(t){const e=this.activeSteps;Object.values(e).forEach((e=>{const{tipElement:i}=e,n=i.querySelector(".guide-button.guide-next-button"),s=i.querySelector(".guide-button.guide-prev-button"),o=i.querySelector(".guide-button.guide-done-button"),{stepNumber:a,steps:r}=t,l=r.length;a>0?(s?.classList.remove("hide"),s?.classList.add("show")):(s?.classList.remove("show"),s?.classList.add("hide")),o&&a===l-1?(n?.classList.remove("show"),n?.classList.add("hide"),o?.classList.remove("hide"),o?.classList.add("show")):(o?.classList.remove("show"),o?.classList.add("hide"),n?.classList.remove("hide"),n?.classList.add("show"))}))}}}));
